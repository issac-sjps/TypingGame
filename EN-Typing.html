<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Master</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            color: white;
        }
        
        html {
            height: 100%;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        /* Homepage Styles */
        .homepage {
            display: block;
        }
        
        .difficulty-section {
            margin-bottom: 40px;
        }
        
        .difficulty-header {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .lesson-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .lesson-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .lesson-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .lesson-number {
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .lesson-number.beginner {
            background: linear-gradient(45deg, #4ade80, #22c55e);
        }
        
        .lesson-number.intermediate {
            background: linear-gradient(45deg, #fbbf24, #f59e0b);
        }
        
        .lesson-number.advanced {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }
        
        .lesson-number.hell {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            animation: hellPulse 2s infinite;
        }
        
        @keyframes hellPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(139, 92, 246, 0); }
        }
        
        .lesson-content {
            flex: 1;
        }
        
        .lesson-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #ffd700;
        }
        
        .lesson-description {
            font-size: 0.95rem;
            opacity: 0.9;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .lesson-preview {
            background: rgba(0, 0, 0, 0.2);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #e0e0e0;
            border-left: 3px solid #ffd700;
        }
        
        .lesson-status {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .lesson-status.completed {
            background: linear-gradient(45deg, #4ade80, #22c55e);
            color: white;
            animation: completedPulse 2s infinite;
        }
        
        .lesson-status.hell-score {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
            animation: hellScorePulse 2s infinite;
            width: 45px;
            height: 45px;
        }
        
        @keyframes hellScorePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 8px rgba(139, 92, 246, 0); }
        }
        
        @keyframes completedPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(74, 222, 128, 0); }
        }
        
        .lesson-difficulty {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .difficulty-beginner {
            background: linear-gradient(45deg, #4ade80, #22c55e);
        }
        
        .difficulty-intermediate {
            background: linear-gradient(45deg, #fbbf24, #f59e0b);
        }
        
        .difficulty-advanced {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }
        
        .difficulty-hell {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            animation: hellBadgePulse 3s infinite;
        }
        
        @keyframes hellBadgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Game Page Styles */
        .game-page {
            display: none;
        }
        
        .back-button {
            background: linear-gradient(45deg, #6b7280, #4b5563);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }
        
        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .lesson-stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: stretch;
        }
        
        .current-lesson-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
            text-align: left;
            flex: 1;
        }
        
        .current-lesson-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }
        
        .current-lesson-instruction {
            font-size: 0.75rem;
            opacity: 0.9;
        }
        
        .stats-controls-container {
            display: flex;
            gap: 10px;
            min-width: 400px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 15px;
            flex: 1;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd700;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .text-display {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1rem;
            line-height: 1.5;
            margin-bottom: 12px;
            min-height: 120px;
            max-height: 120px;
            overflow-y: auto;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
            white-space: pre-wrap;
            word-wrap: break-word;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .char {
            position: relative;
        }
        
        .char.correct {
            background-color: #4ade80;
            color: white;
        }
        
        .char.incorrect {
            background-color: #ef4444;
            color: white;
        }
        
        .char.current {
            background-color: #3b82f6;
            color: white;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        
        .input-area {
            margin-bottom: 15px;
        }
        
        .typing-input {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            outline: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            min-height: 120px;
            max-height: 120px;
            overflow-y: auto;
            resize: none;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.5;
            box-sizing: border-box;
        }
        
        .keyboard {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            position: relative;
            width: 100%;
            max-width: 100%;
        }
        
        .hands-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: max(15px, 1.5vw);
            padding: 0 max(50px, 5vw);
        }
        
        .hand {
            display: flex;
            gap: max(8px, 0.8vw);
            align-items: flex-end;
        }
        
        .finger {
            width: max(18px, 1.8vw);
            height: max(45px, 4.5vw);
            background: rgba(255, 255, 255, 0.3);
            border-radius: max(8px, 0.8vw) max(8px, 0.8vw) max(4px, 0.4vw) max(4px, 0.4vw);
            position: relative;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            font-size: max(0.5rem, min(0.6rem, 0.8vw));
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            padding-bottom: max(3px, 0.3vw);
        }
        
        .finger.thumb {
            height: max(30px, 3vw);
            width: max(22px, 2.2vw);
            margin-top: max(15px, 1.5vw);
        }
        
        .finger.pinky {
            height: max(35px, 3.5vw);
        }
        
        .finger.ring {
            height: max(42px, 4.2vw);
        }
        
        .finger.middle {
            height: max(45px, 4.5vw);
        }
        
        .finger.index {
            height: max(42px, 4.2vw);
        }
        
        .finger.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.8);
            transform: translateY(-5px);
            animation: fingerPulse 1s infinite;
        }
        
        @keyframes fingerPulse {
            0%, 100% { transform: translateY(-5px) scale(1); }
            50% { transform: translateY(-8px) scale(1.1); }
        }
        
        .left-hand .finger:nth-child(1) { background-color: rgba(255, 182, 193, 0.6); } /* Â∞èÊåá */
        .left-hand .finger:nth-child(2) { background-color: rgba(255, 218, 185, 0.6); } /* ÁÑ°ÂêçÊåá */
        .left-hand .finger:nth-child(3) { background-color: rgba(255, 255, 186, 0.6); } /* ‰∏≠Êåá */
        .left-hand .finger:nth-child(4) { background-color: rgba(186, 255, 201, 0.6); } /* È£üÊåá */
        .left-hand .finger:nth-child(5) { background-color: rgba(186, 225, 255, 0.6); } /* ÊãáÊåá */
        
        .right-hand .finger:nth-child(1) { background-color: rgba(186, 225, 255, 0.6); } /* ÊãáÊåá */
        .right-hand .finger:nth-child(2) { background-color: rgba(186, 255, 201, 0.6); } /* È£üÊåá */
        .right-hand .finger:nth-child(3) { background-color: rgba(255, 255, 186, 0.6); } /* ‰∏≠Êåá */
        .right-hand .finger:nth-child(4) { background-color: rgba(255, 218, 185, 0.6); } /* ÁÑ°ÂêçÊåá */
        .right-hand .finger:nth-child(5) { background-color: rgba(255, 182, 193, 0.6); } /* Â∞èÊåá */
        
        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
            gap: min(3px, 0.3vw);
            width: 100%;
        }
        
        .key {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: min(6px, 0.5vw);
            padding: min(8px, 0.8vw);
            min-width: max(35px, 3.5vw);
            height: max(35px, 3.5vw);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: max(0.6rem, min(0.8rem, 1vw));
            transition: all 0.1s ease;
            cursor: pointer;
            flex: 1;
            max-width: 4.5vw;
        }
        
        .key-letter {
            font-size: max(0.9rem, min(1.1rem, 1.2vw));
            font-weight: bold;
            line-height: 1;
        }
        
        .finger-hint {
            font-size: max(0.4rem, min(0.5rem, 0.6vw));
            opacity: 0.7;
            margin-top: 2px;
            line-height: 1;
        }
        
        .key:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .key.pressed {
            background: #ffd700;
            color: #333;
            transform: scale(0.95);
        }
        
        .key.next {
            background: #ff6b6b;
            color: white;
            animation: pulse 1s infinite;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .key.space {
            min-width: max(150px, 15vw);
            max-width: 25vw;
            flex: 3;
        }
        
        .key.wide {
            min-width: max(60px, 6vw);
            max-width: 8vw;
            flex: 1.5;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 120px;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn.secondary {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
        }
        
        .result {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-top: 20px;
            display: none;
        }
        
        .result.show {
            display: block;
        }
        
        .input-warning {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            display: none;
            animation: shake 0.5s ease-in-out;
        }
        
        .input-warning.show {
            display: block;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(45deg, #4ade80, #22c55e);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .celebration {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 20px;
            animation: celebrate 2s ease-in-out;
        }
        
        @keyframes celebrate {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }
        
        .performance-feedback {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .feedback-excellent {
            background: linear-gradient(45deg, #4ade80, #22c55e);
            color: white;
        }
        
        .feedback-good {
            background: linear-gradient(45deg, #fbbf24, #f59e0b);
            color: white;
        }
        
        .feedback-needs-improvement {
            background: linear-gradient(45deg, #ef4444, #dc2626);
            color: white;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .completion-modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-overlay.show .completion-modal {
            transform: scale(1);
            opacity: 1;
        }
        
        .modal-celebration {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: modalCelebrate 1.5s ease-in-out;
        }
        
        @keyframes modalCelebrate {
            0% { transform: scale(0) rotate(0deg); }
            50% { transform: scale(1.3) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }
        
        .modal-title {
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .modal-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .modal-stat-item {
            text-align: center;
        }
        
        .modal-stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd700;
            display: block;
        }
        
        .modal-stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .modal-feedback {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .modal-actions {
            margin-top: 25px;
        }
        
        .modal-button-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .modal-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            flex: 1;
            min-width: 120px;
            max-width: 150px;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .modal-btn.primary {
            background: linear-gradient(45deg, #4ade80, #22c55e);
        }
        
        .modal-btn.secondary {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
        }
        
        .modal-btn.tertiary {
            background: linear-gradient(45deg, #6b7280, #4b5563);
        }
        
        .next-lesson-preview {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
        }
        
        .next-lesson-title {
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
        }
        
        .next-lesson-text {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            opacity: 0.8;
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Homepage -->
        <div class="homepage" id="homepage">
            <header class="header">
                <h1 class="title">‚ö° Êñ∞ËéäÂúãÂ∞è-Ëã±ÊñáÂø´ÊâìÈ´òÊâã ‚ö°</h1>
                <p class="subtitle">ÈÅ∏ÊìáÈóúÂç°ÈñãÂßã‰Ω†ÁöÑÊâìÂ≠óÁ∑¥Áøí‰πãÊóÖÔºÅ</p>
            </header>
            
            <div id="lessonContainer">
                <!-- Lesson sections will be generated here -->
            </div>
        </div>
        
        <!-- Game Page -->
        <div class="game-page" id="gamePage">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <button class="back-button" onclick="goToHomepage()" style="margin-bottom: 0;">‚Üê ËøîÂõûÈóúÂç°ÈÅ∏Êìá</button>
                <div style="font-size: 0.8rem; opacity: 0.7;">
                    üí° Êåâ‰∏ã F11 ÂèØ‰ª•ËÆäÊàêÂÖ®Ëû¢ÂπïÊ®°ÂºèÔºåÂÜçÊåâ‰∏Ä‰∏ã F11 ÈóúÈñâÂÖ®Ëû¢ÂπïÊ®°Âºè
                </div>
            </div>
            
            <div class="lesson-stats-row">
                <div class="current-lesson-info" id="currentLessonInfo">
                    <div class="current-lesson-title" id="currentLessonTitle"></div>
                    <div class="current-lesson-instruction" id="currentLessonInstruction"></div>
                </div>
                
                <div class="stats-controls-container">
                    <div class="stats">
                        <div class="stat-item">
                            <div class="stat-value" id="wpm">0</div>
                            <div class="stat-label">ÊØèÂàÜÈêòÂ≠óÊï∏</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="accuracy">100%</div>
                            <div class="stat-label">Ê∫ñÁ¢∫Â∫¶</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="time">60</div>
                            <div class="stat-label">Ââ©È§òÊôÇÈñì</div>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn" onclick="startLesson()">ÈñãÂßãÁ∑¥Áøí</button>
                        <button class="btn secondary" onclick="resetTest()">ÈáçÊñ∞ÈñãÂßã</button>
                    </div>
                </div>
            </div>
            
            <div class="input-warning" id="inputWarning">
                ‚ö†Ô∏è Ë´ãÂàáÊèõÂà∞Ëã±ÊñáËº∏ÂÖ•Ê≥ïÔºÅÁõÆÂâçËº∏ÂÖ•ÁöÑ‰∏çÊòØËã±ÊñáÂ≠óÁ¨¶ÔºåË´ãÊåâ Shift ÊàñÈªûÊìäËº∏ÂÖ•Ê≥ïÂàáÊèõÂà∞Ëã±ÊñáÊ®°Âºè„ÄÇ
            </div>
            
            <div class="input-warning" id="uppercaseWarning">
                üí° ÈúÄË¶ÅÂ§ßÂØ´Â≠óÊØçÔºÅ<br>
                ÊñπÊ≥ï1ÔºöÊåâ‰∏ã Caps Lock ÂàáÊèõÊâÄÊúâÂ§ßÂ∞èÂØ´<br>
                ÊñπÊ≥ï2ÔºöÊåâ‰Ωè Shift + Â∞èÂØ´Â≠óÊØç = Â§ßÂØ´Â≠óÊØç
            </div>
            
            <div class="text-display" id="textDisplay">
                ÈªûÊìä„ÄåÈñãÂßãÁ∑¥Áøí„ÄçÈñãÂßãÊâìÂ≠óÁ∑¥ÁøíÔºÅ
            </div>
            
            <div class="input-area">
                <textarea class="typing-input" id="typingInput" placeholder="Êåâ‰∏ãÁ©∫ÁôΩÈçµÈñãÂßãÊàñÊåâ‰∏ãÂè≥‰∏äËßíÈñãÂßãÁ∑¥Áøí -  Êúâ|ÈñÉÁàçÂæå ÊâçËÉΩÈñãÂßãÊâìÂ≠ó" disabled></textarea>
            </div>
            
            <div class="keyboard">
                <div class="hands-container">
                    <div class="hand left-hand">
                        <div class="finger pinky" data-finger="left-pinky">Â∞è</div>
                        <div class="finger ring" data-finger="left-ring">ÁÑ°</div>
                        <div class="finger middle" data-finger="left-middle">‰∏≠</div>
                        <div class="finger index" data-finger="left-index">È£ü</div>
                        <div class="finger thumb" data-finger="left-thumb">Êãá</div>
                    </div>
                    <div class="hand right-hand">
                        <div class="finger thumb" data-finger="right-thumb">Êãá</div>
                        <div class="finger index" data-finger="right-index">È£ü</div>
                        <div class="finger middle" data-finger="right-middle">‰∏≠</div>
                        <div class="finger ring" data-finger="right-ring">ÁÑ°</div>
                        <div class="finger pinky" data-finger="right-pinky">Â∞è</div>
                    </div>
                </div>
                <div class="keyboard-row">
                    <div class="key" data-key="`">~<br>`<br><small>Â∞è</small></div>
                    <div class="key" data-key="1">!<br>1<br><small>Â∞è</small></div>
                    <div class="key" data-key="2">@<br>2<br><small>ÁÑ°</small></div>
                    <div class="key" data-key="3">#<br>3<br><small>‰∏≠</small></div>
                    <div class="key" data-key="4">$<br>4<br><small>È£ü</small></div>
                    <div class="key" data-key="5">%<br>5<br><small>È£ü</small></div>
                    <div class="key" data-key="6">^<br>6<br><small>È£ü</small></div>
                    <div class="key" data-key="7">&<br>7<br><small>È£ü</small></div>
                    <div class="key" data-key="8">*<br>8<br><small>‰∏≠</small></div>
                    <div class="key" data-key="9">(<br>9<br><small>ÁÑ°</small></div>
                    <div class="key" data-key="0">)<br>0<br><small>Â∞è</small></div>
                    <div class="key" data-key="-">_<br>-<br><small>Â∞è</small></div>
                    <div class="key" data-key="=">+<br>=<br><small>Â∞è</small></div>
                    <div class="key wide" data-key="Backspace">‚å´</div>
                </div>
                <div class="keyboard-row">
                    <div class="key wide" data-key="Tab">Tab</div>
                    <div class="key" data-key="q"><span class="key-letter">Q</span><span class="finger-hint">Â∞è</span></div>
                    <div class="key" data-key="w"><span class="key-letter">W</span><span class="finger-hint">ÁÑ°</span></div>
                    <div class="key" data-key="e"><span class="key-letter">E</span><span class="finger-hint">‰∏≠</span></div>
                    <div class="key" data-key="r"><span class="key-letter">R</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="t"><span class="key-letter">T</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="y"><span class="key-letter">Y</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="u"><span class="key-letter">U</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="i"><span class="key-letter">I</span><span class="finger-hint">‰∏≠</span></div>
                    <div class="key" data-key="o"><span class="key-letter">O</span><span class="finger-hint">ÁÑ°</span></div>
                    <div class="key" data-key="p"><span class="key-letter">P</span><span class="finger-hint">Â∞è</span></div>
                    <div class="key" data-key="[">{<br>[<br><small>Â∞è</small></div>
                    <div class="key" data-key="]">}<br>]<br><small>Â∞è</small></div>
                    <div class="key wide" data-key="\\">|<br>\</div>
                </div>
                <div class="keyboard-row">
                    <div class="key wide" data-key="CapsLock">Caps</div>
                    <div class="key" data-key="a"><span class="key-letter">A</span><span class="finger-hint">Â∞è</span></div>
                    <div class="key" data-key="s"><span class="key-letter">S</span><span class="finger-hint">ÁÑ°</span></div>
                    <div class="key" data-key="d"><span class="key-letter">D</span><span class="finger-hint">‰∏≠</span></div>
                    <div class="key" data-key="f"><span class="key-letter">F</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="g"><span class="key-letter">G</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="h"><span class="key-letter">H</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="j"><span class="key-letter">J</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="k"><span class="key-letter">K</span><span class="finger-hint">‰∏≠</span></div>
                    <div class="key" data-key="l"><span class="key-letter">L</span><span class="finger-hint">ÁÑ°</span></div>
                    <div class="key" data-key=";">:<br>;<br><small>Â∞è</small></div>
                    <div class="key" data-key="'">"<br>'<br><small>Â∞è</small></div>
                    <div class="key wide" data-key="Enter">Enter<br><small>Âè≥Â∞è</small></div>
                </div>
                <div class="keyboard-row">
                    <div class="key wide" data-key="Shift">Shift</div>
                    <div class="key" data-key="z"><span class="key-letter">Z</span><span class="finger-hint">Â∞è</span></div>
                    <div class="key" data-key="x"><span class="key-letter">X</span><span class="finger-hint">ÁÑ°</span></div>
                    <div class="key" data-key="c"><span class="key-letter">C</span><span class="finger-hint">‰∏≠</span></div>
                    <div class="key" data-key="v"><span class="key-letter">V</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="b"><span class="key-letter">B</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="n"><span class="key-letter">N</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key="m"><span class="key-letter">M</span><span class="finger-hint">È£ü</span></div>
                    <div class="key" data-key=","><br>,<br><small>‰∏≠</small></div>
                    <div class="key" data-key=".">><br>.<br><small>ÁÑ°</small></div>
                    <div class="key" data-key="/">?<br>/<br><small>Â∞è</small></div>
                    <div class="key wide" data-key="Shift">Shift</div>
                </div>
                <div class="keyboard-row">
                    <div class="key space" data-key=" ">Space</div>
                </div>
            </div>
            
            <div class="result" id="result">
                <div class="celebration" id="celebration">üéâ</div>
                <h3>Ê∏¨Ë©¶ÂÆåÊàêÔºÅ</h3>
                <p id="finalStats"></p>
                <div class="performance-feedback" id="performanceFeedback"></div>
                <div class="controls">
                    <button class="btn" onclick="goToHomepage()">ÈÅ∏ÊìáÂÖ∂‰ªñÈóúÂç°</button>
                    <button class="btn secondary" onclick="resetTest()">ÂÜçË©¶‰∏ÄÊ¨°</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Completion Modal -->
    <div class="modal-overlay" id="completionModal">
        <div class="completion-modal">
            <div class="modal-celebration" id="modalCelebration">üéâ</div>
            <div class="modal-title">ÈóúÂç°ÂÆåÊàêÔºÅ</div>
            
            <div class="modal-stats">
                <div class="modal-stat-item">
                    <span class="modal-stat-value" id="modalWPM">0</span>
                    <div class="modal-stat-label">Â≠ó/ÂàÜÈêò</div>
                </div>
                <div class="modal-stat-item">
                    <span class="modal-stat-value" id="modalAccuracy">100%</span>
                    <div class="modal-stat-label">Ê∫ñÁ¢∫Â∫¶</div>
                </div>
                <div class="modal-stat-item">
                    <span class="modal-stat-value" id="modalChars">0</span>
                    <div class="modal-stat-label">Â≠óÁ¨¶Êï∏</div>
                </div>
            </div>
            
            <div class="modal-feedback" id="modalFeedback">
                üåü Ê∫ñÁ¢∫Â∫¶ÊªøÂàÜÔºÅÈÄüÂ∫¶ÊúÉÈö®ËëóÁ∑¥ÁøíËá™ÁÑ∂ÊèêÂçáÁöÑÔºÅ
            </div>
            
            <div class="next-lesson-preview" id="nextLessonPreview" style="display: none;">
                <div class="next-lesson-title" id="nextLessonTitle">‰∏ã‰∏ÄÈóúÔºöÂü∫Êú¨ÂñÆÂ≠ó</div>
                <div class="next-lesson-text" id="nextLessonText">ask dad fall glass hall jazz</div>
            </div>
            
            <div class="modal-actions">
                <div class="modal-button-row">
                    <button class="modal-btn primary" id="nextLessonBtn" onclick="goToNextLesson()" style="display: none;">
                        üöÄ ÊåëÊà∞‰∏ã‰∏ÄÈóú
                    </button>
                    <button class="modal-btn secondary" onclick="resetTest(); closeModal();">
                        üîÑ ÂÜçË©¶‰∏ÄÊ¨°
                    </button>
                    <button class="modal-btn tertiary" onclick="goToHomepage(); closeModal();">
                        üìö ÈÅ∏ÊìáÂÖ∂‰ªñÈóúÂç°
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Finger mapping for each key
        const fingerMapping = {
            // Left hand
            '`': 'left-pinky', '1': 'left-pinky', 'q': 'left-pinky', 'a': 'left-pinky', 'z': 'left-pinky',
            '2': 'left-ring', 'w': 'left-ring', 's': 'left-ring', 'x': 'left-ring',
            '3': 'left-middle', 'e': 'left-middle', 'd': 'left-middle', 'c': 'left-middle',
            '4': 'left-index', '5': 'left-index', 'r': 'left-index', 't': 'left-index', 
            'f': 'left-index', 'g': 'left-index', 'v': 'left-index', 'b': 'left-index',
            
            // Right hand  
            '6': 'right-index', '7': 'right-index', 'y': 'right-index', 'u': 'right-index',
            'h': 'right-index', 'j': 'right-index', 'n': 'right-index', 'm': 'right-index',
            '8': 'right-middle', 'i': 'right-middle', 'k': 'right-middle', ',': 'right-middle',
            '9': 'right-ring', 'o': 'right-ring', 'l': 'right-ring', '.': 'right-ring',
            '0': 'right-pinky', '-': 'right-pinky', '=': 'right-pinky', 'p': 'right-pinky',
            '[': 'right-pinky', ']': 'right-pinky', '\\': 'right-pinky', ';': 'right-pinky',
            "'": 'right-pinky', '/': 'right-pinky',
            
            // Space bar - both thumbs, but we'll use left thumb as default
            ' ': 'left-thumb',
            
            // Enter key - right pinky
            'Enter': 'right-pinky'
        };

        // Special characters that require Shift key
        const shiftCharMapping = {
            '!': '1', '@': '2', '#': '3', '$': '4', '%': '5',
            '^': '6', '&': '7', '*': '8', '(': '9', ')': '0',
            '_': '-', '+': '=', '~': '`',
            'Q': 'q', 'W': 'w', 'E': 'e', 'R': 'r', 'T': 't',
            'Y': 'y', 'U': 'u', 'I': 'i', 'O': 'o', 'P': 'p',
            '{': '[', '}': ']', '|': '\\',
            'A': 'a', 'S': 's', 'D': 'd', 'F': 'f', 'G': 'g',
            'H': 'h', 'J': 'j', 'K': 'k', 'L': 'l', ':': ';', '"': "'",
            'Z': 'z', 'X': 'x', 'C': 'c', 'V': 'v', 'B': 'b',
            'N': 'n', 'M': 'm', '<': ',', '>': '.', '?': '/'
        };

        const lessons = [
            {
                title: "01 Âü∫Á§éÈçµ‰ΩçÁ∑¥Áøí(‰∏≠ÊéíÂ≠óÊØç)",
                text: "asdf jkl;",
                instruction: "Â∞áÊâãÊåáÊîæÂú®Âü∫Ê∫ñÈçµ‰Ωç‰∏ä„ÄÇÂ∑¶ÊâãÔºöA S D FÔºåÂè≥ÊâãÔºöJ K L ;",
                description: "Â≠∏ÁøíÊ≠£Á¢∫ÁöÑÊâãÊåá‰ΩçÁΩÆÔºåÂª∫Á´ãËÇåËÇâË®òÊÜ∂ÁöÑÂü∫Á§é",
                difficulty: "beginner"
            },
            {
                title: "02 Âü∫Êú¨ÂñÆÂ≠ó-‰∏≠ÊéíÂ≠óÊØç",
                text: "ask dad fall glass hall jazz",
                instruction: "‰ΩøÁî®Âü∫Ê∫ñÈçµ‰ΩçÊâìÈÄô‰∫õÁ∞°ÂñÆÁöÑÂñÆÂ≠ó",
                description: "Á∑¥ÁøíÂ∏∏Ë¶ãÁöÑÁü≠ÂñÆÂ≠óÔºåÁÜüÊÇâÂü∫Êú¨Èçµ‰ΩçÁµÑÂêà",
                difficulty: "beginner"
            },
            {
                title: "03 ‰∏äÊéíÂ≠óÊØç",
                text: "qwer tyui op",
                instruction: "Á∑¥Áøí‰∏äÊéíÈçµ‰Ωç„ÄÇÂæûÂü∫Ê∫ñ‰ΩçÁΩÆÂêë‰∏ä‰º∏Â±ï",
                description: "ÊéåÊè°‰∏äÊéíÂ≠óÊØçÁöÑÊâìÂ≠óÊäÄÂ∑ßÔºåÊèêÂçáÊâãÊåáÈùàÊ¥ªÂ∫¶",
                difficulty: "beginner"
            },
            {
                title: "04 ‰∏ãÊéíÂ≠óÊØç", 
                text: "zxcv bnm",
                instruction: "Á∑¥Áøí‰∏ãÊéíÈçµ‰Ωç„ÄÇÂæûÂü∫Ê∫ñ‰ΩçÁΩÆÂêë‰∏ã‰º∏Â±ï",
                description: "Â≠∏Áøí‰∏ãÊéíÂ≠óÊØçÔºåÂÆåÊàêÊâÄÊúâÂ≠óÊØçÁöÑÂü∫Á§éÁ∑¥Áøí",
                difficulty: "beginner"
            },
            {
                title: "05 Êï∏Â≠óÁ∑¥Áøí",
                text: "123 456 789 0",
                instruction: "Áî®ÊâãÊåáÂêë‰∏ä‰º∏Â±ïÂà∞Êï∏Â≠óÂàó",
                description: "Á∑¥ÁøíÊï∏Â≠óËº∏ÂÖ•ÔºåÊèêÂçáÊï∏ÊìöËôïÁêÜËÉΩÂäõ",
                difficulty: "intermediate"
            },
            {
                title: "06 Â∏∏Áî®ÂñÆÂ≠ó",
                text: "the and for are but not you all can had",
                instruction: "Á∑¥ÁøíÊâìÂ∏∏Áî®ÁöÑËã±ÊñáÂñÆÂ≠ó",
                description: "ÊéåÊè°È´òÈ†ªËã±ÊñáÂñÆÂ≠óÔºåÊèêÂçáÂØ¶Áî®ÊâìÂ≠óÊäÄËÉΩ",
                difficulty: "intermediate"
            },
            {
                title: "07 Â§ßÂØ´Â≠óÊØç",
                text: "The Quick Brown Fox Jumps Over The Lazy Dog",
                instruction: "Áî®Áõ∏ÂèçÊâãÊåâ‰Ωè Shift Èçµ‰æÜÊâìÂ§ßÂØ´Â≠óÊØç",
                description: "Â≠∏ÁøíÂ§ßÂ∞èÂØ´ÂàáÊèõÔºåÊéåÊè°Ê≠£Á¢∫ÁöÑ Shift Èçµ‰ΩøÁî®ÊñπÊ≥ï",
                difficulty: "intermediate"
            },
            {
                title: "08 Ê®ôÈªûÁ¨¶ËôüÁ∑¥Áøí",
                text: "Hello, world! How are you? I'm fine, thanks.",
                instruction: "Á∑¥ÁøíÊ®ôÈªûÁ¨¶ËôüÔºöÈÄóËôü„ÄÅÂè•Ëôü„ÄÅÂïèËôü„ÄÅÊíáËôü",
                description: "ÊéåÊè°Â∏∏Áî®Ê®ôÈªûÁ¨¶ËôüÔºåÊèêÂçáÊñáÁ´†Ëº∏ÂÖ•ËÉΩÂäõ",
                difficulty: "intermediate"
            },
            {
                title: "09 Á∂úÂêàÁ∑¥Áøí",
                text: "Technology has changed our world in amazing ways.",
                instruction: "ÁµêÂêàÊâÄÊúâÊäÄÂ∑ßÔºöÂ≠óÊØç„ÄÅÂ§ßÂØ´„ÄÅÊ®ôÈªûÁ¨¶ËôüÂíåÁ©∫Ê†º",
                description: "Á∂úÂêàÈÅãÁî®ÊâÄÊúâÊäÄÂ∑ßÔºåÊåëÊà∞ÂÆåÊï¥Âè•Â≠êËº∏ÂÖ•",
                difficulty: "advanced"
            },
            {
                title: "10 ÈÄüÂ∫¶ÊåëÊà∞",
                text: "The quick brown fox jumps over the lazy dog and runs through the forest.",
                instruction: "Â∞àÊ≥®ÊñºÈÄüÂ∫¶ÔºåÂêåÊôÇ‰øùÊåÅÊ∫ñÁ¢∫Â∫¶",
                description: "ÁµÇÊ•µÈÄüÂ∫¶ÊåëÊà∞ÔºåÊ∏¨Ë©¶‰Ω†ÁöÑÊâìÂ≠óÊ•µÈôê",
                difficulty: "advanced"
            },
            {
                title: "11 Âú∞ÁçÑÈóúÂç° - 500Â≠óÊåëÊà∞",
                text: "In the digital age, technology has revolutionized the way we communicate, work, and live our daily lives.\nFrom smartphones that connect us instantly to people across the globe, to artificial intelligence that helps us solve complex problems, the impact of technological advancement is undeniable.\nSocial media platforms have transformed how we share information and maintain relationships, while cloud computing has made it possible for businesses to operate more efficiently than ever before.\nThe internet has democratized access to knowledge, allowing anyone with a connection to learn new skills, explore different cultures, and stay informed about world events.\nHowever, this rapid technological progress also brings challenges that we must carefully consider.\nPrivacy concerns have become increasingly important as our personal data is collected and analyzed by various companies and organizations.\nCybersecurity threats pose risks to individuals, businesses, and governments alike, requiring constant vigilance and updated protection measures.\nThe digital divide continues to separate those who have access to technology from those who do not, creating inequalities in education and economic opportunities.\nDespite these challenges, the potential benefits of technology remain enormous, promising solutions to some of humanity's greatest problems including climate change, disease, and poverty.",
                instruction: "5ÂàÜÈêòÂÖßÁõ°ÂèØËÉΩÊ≠£Á¢∫Ëº∏ÂÖ•Êõ¥Â§öÂ≠óÁ¨¶ÔºåÊØèÊ≠£Á¢∫‰∏ÄÂ≠óÂæó‰∏ÄÂàÜÔºÅÈúÄË¶ÅÊåâ Enter ÊèõË°å",
                description: "ÁµÇÊ•µÊåëÊà∞ÔºÅ500Â≠óËã±ÊñáÊñáÁ´†ÔºåÊ∏¨Ë©¶‰Ω†ÁöÑÊ•µÈôêÊâìÂ≠óËÉΩÂäõ",
                difficulty: "hell"
            }
        ];
        
        let currentLesson = -1;
        let currentText = '';
        let currentIndex = 0;
        let startTime = null;
        let timer = null;
        let timeLeft = 60;
        let isTestActive = false;
        let correctChars = 0;
        let totalChars = 0;
        let completedLessons = JSON.parse(localStorage.getItem('completedLessons') || '[]');
        let hellScores = JSON.parse(localStorage.getItem('hellScores') || '{}');
        
        const homepage = document.getElementById('homepage');
        const gamePage = document.getElementById('gamePage');
        const lessonContainer = document.getElementById('lessonContainer');
        const textDisplay = document.getElementById('textDisplay');
        const typingInput = document.getElementById('typingInput');
        const wpmElement = document.getElementById('wpm');
        const accuracyElement = document.getElementById('accuracy');
        const timeElement = document.getElementById('time');
        const resultElement = document.getElementById('result');
        const finalStatsElement = document.getElementById('finalStats');
        const currentLessonTitle = document.getElementById('currentLessonTitle');
        const currentLessonInstruction = document.getElementById('currentLessonInstruction');
        const inputWarning = document.getElementById('inputWarning');
        
        function initHomepage() {
            lessonContainer.innerHTML = '';
            
            // Group lessons by difficulty
            const difficultyGroups = {
                'beginner': { title: 'üå± ÂàùÁ¥öÈóúÂç°', lessons: [] },
                'intermediate': { title: 'üöÄ ‰∏≠Á¥öÈóúÂç°', lessons: [] },
                'advanced': { title: 'üèÜ È´òÁ¥öÈóúÂç°', lessons: [] },
                'hell': { title: 'üëπ Âú∞ÁçÑÈóúÂç°', lessons: [] }
            };
            
            lessons.forEach((lesson, index) => {
                difficultyGroups[lesson.difficulty].lessons.push({ ...lesson, index });
            });
            
            // Create sections for each difficulty
            Object.keys(difficultyGroups).forEach(difficulty => {
                const group = difficultyGroups[difficulty];
                if (group.lessons.length === 0) return;
                
                const section = document.createElement('div');
                section.className = 'difficulty-section';
                
                const header = document.createElement('div');
                header.className = 'difficulty-header';
                header.textContent = group.title;
                section.appendChild(header);
                
                const lessonList = document.createElement('div');
                lessonList.className = 'lesson-list';
                
                group.lessons.forEach(lesson => {
                    const card = document.createElement('div');
                    card.className = 'lesson-card';
                    card.onclick = () => selectLesson(lesson.index);
                    
                    const isCompleted = completedLessons.includes(lesson.index);
                    const isHell = lesson.difficulty === 'hell';
                    const hellScore = hellScores[lesson.index] || 0;
                    
                    let statusContent = '';
                    let statusClass = '';
                    
                    if (isHell) {
                        if (hellScore > 0) {
                            statusContent = hellScore;
                            statusClass = 'hell-score';
                        }
                    } else if (isCompleted) {
                        statusContent = '‚úì';
                        statusClass = 'completed';
                    }
                    
                    card.innerHTML = `
                        <div class="lesson-number ${lesson.difficulty}">${lesson.index + 1}</div>
                        <div class="lesson-content">
                            <div class="lesson-title">${lesson.title}</div>
                            <div class="lesson-description">${lesson.description}</div>
                            <div class="lesson-preview">${lesson.text.length > 100 ? lesson.text.substring(0, 100) + '...' : lesson.text}</div>
                        </div>
                        <div class="lesson-status ${statusClass}">${statusContent}</div>
                    `;
                    
                    lessonList.appendChild(card);
                });
                
                section.appendChild(lessonList);
                lessonContainer.appendChild(section);
            });
        }
        
        function markLessonCompleted(lessonIndex) {
            if (!completedLessons.includes(lessonIndex)) {
                completedLessons.push(lessonIndex);
                localStorage.setItem('completedLessons', JSON.stringify(completedLessons));
            }
        }
        
        function saveHellScore(lessonIndex, score) {
            const currentScore = hellScores[lessonIndex] || 0;
            if (score > currentScore) {
                hellScores[lessonIndex] = score;
                localStorage.setItem('hellScores', JSON.stringify(hellScores));
                return true; // New record
            }
            return false; // Not a new record
        }
        
        function selectLesson(lessonIndex) {
            currentLesson = lessonIndex;
            const lesson = lessons[currentLesson];
            
            currentLessonTitle.textContent = `Á¨¨ ${currentLesson + 1} ÈóúÔºö${lesson.title}`;
            currentLessonInstruction.textContent = lesson.instruction;
            
            homepage.style.display = 'none';
            gamePage.style.display = 'block';
            
            resetTest();
        }
        
        function goToHomepage() {
            homepage.style.display = 'block';
            gamePage.style.display = 'none';
            resetTest();
            initHomepage(); // Refresh homepage to show updated completion status
        }
        
        function startLesson() {
            const lesson = lessons[currentLesson];
            currentText = lesson.text;
            currentIndex = 0;
            correctChars = 0;
            totalChars = 0;
            
            // Set time based on lesson type
            if (lesson.difficulty === 'hell') {
                timeLeft = 300; // 5 minutes for hell mode
            } else {
                timeLeft = 60; // 1 minute for normal lessons
            }
            
            isTestActive = false;
            startTime = null;
            
            displayText();
            highlightNextKey();
            typingInput.disabled = false;
            typingInput.value = '';
            typingInput.focus();
            
            timeElement.textContent = timeLeft;
            wpmElement.textContent = '0';
            accuracyElement.textContent = '100%';
            resultElement.classList.remove('show');
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
        }
        
        function displayText() {
            let html = '';
            for (let i = 0; i < currentText.length; i++) {
                let className = '';
                if (i < currentIndex) {
                    className = typingInput.value[i] === currentText[i] ? 'correct' : 'incorrect';
                } else if (i === currentIndex) {
                    className = 'current';
                }
                
                let char = currentText[i];
                if (char === '\n') {
                    html += `<span class="char ${className}">‚Üµ</span><br>`;
                } else if (char === ' ') {
                    html += `<span class="char ${className}">&nbsp;</span>`;
                } else {
                    html += `<span class="char ${className}">${char}</span>`;
                }
            }
            textDisplay.innerHTML = html;
            
            // Auto-scroll to keep current character visible
            const currentChar = textDisplay.querySelector('.char.current');
            if (currentChar) {
                const displayRect = textDisplay.getBoundingClientRect();
                const charRect = currentChar.getBoundingClientRect();
                
                // If current character is below the visible area, scroll down
                if (charRect.bottom > displayRect.bottom - 20) {
                    textDisplay.scrollTop += charRect.bottom - displayRect.bottom + 30;
                }
                // If current character is above the visible area, scroll up
                else if (charRect.top < displayRect.top + 20) {
                    textDisplay.scrollTop -= displayRect.top - charRect.top + 30;
                }
            }
        }
        
        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                timeElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }
        
        function calculateWPM() {
            if (!startTime) return 0;
            const timeElapsed = (Date.now() - startTime) / 1000 / 60;
            const wordsTyped = correctChars / 5;
            return Math.round(wordsTyped / timeElapsed);
        }
        
        function calculateAccuracy() {
            if (totalChars === 0) return 100;
            return Math.round((correctChars / totalChars) * 100);
        }
        
        function updateStats() {
            wpmElement.textContent = calculateWPM();
            accuracyElement.textContent = calculateAccuracy() + '%';
        }
        
        function endTest() {
            isTestActive = false;
            typingInput.disabled = true;
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            const finalWPM = calculateWPM();
            const finalAccuracy = calculateAccuracy();
            const lesson = lessons[currentLesson];
            
            // Handle scoring based on lesson type
            let isNewRecord = false;
            if (lesson.difficulty === 'hell') {
                // For hell mode, score is the number of correct characters
                isNewRecord = saveHellScore(currentLesson, correctChars);
            } else {
                // Mark lesson as completed if accuracy is 100%
                if (finalAccuracy === 100) {
                    markLessonCompleted(currentLesson);
                }
            }
            
            finalStatsElement.innerHTML = `
                <strong>ÊúÄÁµÇÁµêÊûúÔºö</strong><br>
                ÈÄüÂ∫¶Ôºö${finalWPM} Â≠ó/ÂàÜÈêò<br>
                Ê∫ñÁ¢∫Â∫¶Ôºö${finalAccuracy}%<br>
                Â∑≤ÊâìÂ≠óÊï∏Ôºö${totalChars} ÂÄãÂ≠óÁ¨¶
            `;
            
            // Generate performance feedback
            const feedbackElement = document.getElementById('performanceFeedback');
            const celebrationElement = document.getElementById('celebration');
            
            let feedbackText = '';
            let feedbackClass = '';
            let celebrationEmoji = 'üéâ';
            
            if (lesson.difficulty === 'hell') {
                // Hell mode feedback based on correct characters
                if (isNewRecord) {
                    celebrationEmoji = 'üî•üëπüèÜ';
                    feedbackText = `üî• Êñ∞Á¥ÄÈåÑÔºÅ‰Ω†Ê≠£Á¢∫Ëº∏ÂÖ•‰∫Ü ${correctChars} ÂÄãÂ≠óÁ¨¶ÔºÅÂú∞ÁçÑÁ¥öË°®ÁèæÔºÅ`;
                    feedbackClass = 'feedback-excellent';
                } else if (correctChars >= 400) {
                    celebrationEmoji = 'üëπüî•';
                    feedbackText = `üëπ Âú∞ÁçÑÁ¥öÈ´òÊâãÔºÅ${correctChars} ÂÄãÊ≠£Á¢∫Â≠óÁ¨¶ÔºåÂ§™Âº∑‰∫ÜÔºÅ`;
                    feedbackClass = 'feedback-excellent';
                } else if (correctChars >= 300) {
                    celebrationEmoji = 'üî•üí™';
                    feedbackText = `üî• Ë°®ÁèæÂÑ™Áï∞ÔºÅ${correctChars} ÂÄãÊ≠£Á¢∫Â≠óÁ¨¶ÔºåÁπºÁ∫åÊåëÊà∞Êõ¥È´òÂàÜÔºÅ`;
                    feedbackClass = 'feedback-good';
                } else if (correctChars >= 200) {
                    celebrationEmoji = 'üí™üìà';
                    feedbackText = `üí™ ‰∏çÈåØÁöÑÈñãÂßãÔºÅ${correctChars} ÂÄãÊ≠£Á¢∫Â≠óÁ¨¶ÔºåÂ§öÁ∑¥ÁøíÊúÉÊõ¥Â•ΩÔºÅ`;
                    feedbackClass = 'feedback-good';
                } else {
                    celebrationEmoji = 'üéØüí°';
                    feedbackText = `üéØ ÂãáÊï¢ÊåëÊà∞ÔºÅ${correctChars} ÂÄãÊ≠£Á¢∫Â≠óÁ¨¶ÔºåÂú∞ÁçÑÈóúÂç°ÈúÄË¶ÅÊõ¥Â§öÁ∑¥ÁøíÔºÅ`;
                    feedbackClass = 'feedback-needs-improvement';
                }
            } else {
                // Normal mode feedback
                if (finalAccuracy >= 95 && finalWPM >= 40) {
                    feedbackText = 'üèÜ ÂÆåÁæéË°®ÁèæÔºÅ‰Ω†ÊòØÁúüÊ≠£ÁöÑÊâìÂ≠óÈ´òÊâãÔºÅ';
                    feedbackClass = 'feedback-excellent';
                    celebrationEmoji = 'üèÜüéâ‚ú®';
                } else if (finalAccuracy >= 90 && finalWPM >= 25) {
                    feedbackText = '‚≠ê Ë°®ÁèæÂÑ™ÁßÄÔºÅÁπºÁ∫å‰øùÊåÅÈÄôÂÄãÊ∞¥Ê∫ñÔºÅ';
                    feedbackClass = 'feedback-excellent';
                    celebrationEmoji = '‚≠êüéâ';
                } else if (finalAccuracy >= 80 && finalWPM >= 15) {
                    feedbackText = 'üëç ‰∏çÈåØÁöÑÈÄ≤Ê≠•ÔºÅÂ§öÁ∑¥ÁøíÂ∞±ËÉΩÊõ¥Âø´Êõ¥Ê∫ñÔºÅ';
                    feedbackClass = 'feedback-good';
                    celebrationEmoji = 'üëçüí™';
                } else if (finalAccuracy >= 70) {
                    feedbackText = 'üìà ÊåÅÁ∫åÁ∑¥ÁøíÔºÅÂ∞àÊ≥®ÊñºÊ∫ñÁ¢∫Â∫¶ÊúÉËÆìÈÄüÂ∫¶Ëá™ÁÑ∂ÊèêÂçáÔºÅ';
                    feedbackClass = 'feedback-good';
                    celebrationEmoji = 'üìàüéØ';
                } else {
                    feedbackText = 'üéØ Âà•ÁÅ∞ÂøÉÔºÅÊÖ¢ÊÖ¢‰æÜÔºåÂÖàËøΩÊ±ÇÊ∫ñÁ¢∫Â∫¶ÂÜçÊèêÂçáÈÄüÂ∫¶ÔºÅ';
                    feedbackClass = 'feedback-needs-improvement';
                    celebrationEmoji = 'üéØüí°';
                }
                
                // Special encouragement for beginners
                if (finalWPM < 10 && finalAccuracy === 100) {
                    feedbackText = 'üåü Ê∫ñÁ¢∫Â∫¶ÊªøÂàÜÔºÅÈÄüÂ∫¶ÊúÉÈö®ËëóÁ∑¥ÁøíËá™ÁÑ∂ÊèêÂçáÁöÑÔºÅ';
                    feedbackClass = 'feedback-good';
                    celebrationEmoji = 'üåüüéØ';
                }
            }
            
            celebrationElement.textContent = celebrationEmoji;
            feedbackElement.textContent = feedbackText;
            feedbackElement.className = `performance-feedback ${feedbackClass}`;
            
            // Show floating modal instead of inline result
            showCompletionModal(finalWPM, finalAccuracy, totalChars, feedbackText, celebrationEmoji);
        }
        
        function showCompletionModal(wpm, accuracy, chars, feedbackText, celebrationEmoji) {
            const modal = document.getElementById('completionModal');
            const modalWPM = document.getElementById('modalWPM');
            const modalAccuracy = document.getElementById('modalAccuracy');
            const modalChars = document.getElementById('modalChars');
            const modalFeedback = document.getElementById('modalFeedback');
            const modalCelebration = document.getElementById('modalCelebration');
            const nextLessonPreview = document.getElementById('nextLessonPreview');
            const nextLessonBtn = document.getElementById('nextLessonBtn');
            const nextLessonTitle = document.getElementById('nextLessonTitle');
            const nextLessonText = document.getElementById('nextLessonText');
            
            // Update modal content
            modalWPM.textContent = wpm;
            modalAccuracy.textContent = accuracy + '%';
            modalChars.textContent = chars;
            modalFeedback.textContent = feedbackText;
            modalCelebration.textContent = celebrationEmoji;
            
            // Show next lesson preview if not the last lesson
            if (currentLesson < lessons.length - 1) {
                const nextLesson = lessons[currentLesson + 1];
                nextLessonTitle.textContent = `‰∏ã‰∏ÄÈóúÔºö${nextLesson.title}`;
                nextLessonText.textContent = nextLesson.text;
                nextLessonPreview.style.display = 'block';
                nextLessonBtn.style.display = 'block';
            } else {
                nextLessonPreview.style.display = 'none';
                nextLessonBtn.style.display = 'none';
            }
            
            // Show modal with animation
            modal.classList.add('show');
        }
        
        function closeModal() {
            const modal = document.getElementById('completionModal');
            modal.classList.remove('show');
        }
        
        function goToNextLesson() {
            if (currentLesson < lessons.length - 1) {
                closeModal();
                selectLesson(currentLesson + 1);
            }
        }
        
        function resetTest() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            currentIndex = 0;
            correctChars = 0;
            totalChars = 0;
            
            // Set default time based on current lesson
            if (currentLesson !== -1 && lessons[currentLesson].difficulty === 'hell') {
                timeLeft = 300; // 5 minutes for hell mode
            } else {
                timeLeft = 60; // 1 minute for normal lessons
            }
            
            isTestActive = false;
            startTime = null;
            
            typingInput.value = '';
            typingInput.disabled = true;
            
            textDisplay.innerHTML = 'ÈªûÊìä„ÄåÈñãÂßãÁ∑¥Áøí„ÄçÈñãÂßãÊâìÂ≠óÁ∑¥ÁøíÔºÅ';
            inputWarning.classList.remove('show');
            document.getElementById('uppercaseWarning').classList.remove('show');
            
            document.querySelectorAll('.key.next').forEach(key => {
                key.classList.remove('next');
            });
            
            document.querySelectorAll('.finger.active').forEach(finger => {
                finger.classList.remove('active');
            });
            timeElement.textContent = timeLeft;
            wpmElement.textContent = '0';
            accuracyElement.textContent = '100%';
            resultElement.classList.remove('show');
        }
        
        function checkInputMethod(inputText) {
            const hasNonASCII = /[^\x00-\x7F]/.test(inputText);
            
            if (hasNonASCII) {
                inputWarning.classList.add('show');
                return false;
            } else {
                inputWarning.classList.remove('show');
                return true;
            }
        }
        
        function checkUppercaseNeeded() {
            const uppercaseWarning = document.getElementById('uppercaseWarning');
            
            if (currentIndex < currentText.length && currentIndex < typingInput.value.length) {
                const expectedChar = currentText[currentIndex];
                const typedChar = typingInput.value[currentIndex];
                
                // Check if we expect uppercase but got lowercase
                if (expectedChar && typedChar && 
                    expectedChar === expectedChar.toUpperCase() && 
                    expectedChar !== expectedChar.toLowerCase() && // It's a letter
                    typedChar === expectedChar.toLowerCase()) {
                    
                    uppercaseWarning.classList.add('show');
                    return true;
                } else {
                    uppercaseWarning.classList.remove('show');
                    return false;
                }
            } else {
                uppercaseWarning.classList.remove('show');
                return false;
            }
        }
        
        function highlightKey(key) {
            const keyElement = document.querySelector(`[data-key="${key}"]`);
            if (keyElement) {
                keyElement.classList.add('pressed');
                setTimeout(() => {
                    keyElement.classList.remove('pressed');
                }, 150);
            }
            
            // Also highlight the finger briefly when key is pressed
            const fingerToUse = fingerMapping[key.toLowerCase()];
            if (fingerToUse) {
                const fingerElement = document.querySelector(`[data-finger="${fingerToUse}"]`);
                if (fingerElement) {
                    fingerElement.style.transform = 'translateY(-10px) scale(1.2)';
                    fingerElement.style.boxShadow = '0 0 25px rgba(255, 107, 107, 1)';
                    setTimeout(() => {
                        fingerElement.style.transform = '';
                        fingerElement.style.boxShadow = '';
                    }, 150);
                }
            }
        }
        
        function highlightNextKey() {
            // Remove previous key highlighting
            document.querySelectorAll('.key.next').forEach(key => {
                key.classList.remove('next');
            });
            
            document.querySelectorAll('.finger.active').forEach(finger => {
                finger.classList.remove('active');
            });
            
            if (currentIndex < currentText.length) {
                const nextChar = currentText[currentIndex];
                let keyToHighlight = nextChar;
                let needsShift = false;
                
                // Check if this character requires Shift
                if (shiftCharMapping[nextChar]) {
                    keyToHighlight = shiftCharMapping[nextChar];
                    needsShift = true;
                    
                    // Highlight Shift key
                    const shiftKeys = document.querySelectorAll('[data-key="Shift"]');
                    shiftKeys.forEach(shiftKey => {
                        shiftKey.classList.add('next');
                    });
                } else if (nextChar === ' ') {
                    keyToHighlight = ' ';
                } else if (nextChar === '\n') {
                    keyToHighlight = 'Enter';
                } else {
                    keyToHighlight = nextChar.toLowerCase();
                }
                
                // Highlight the main key
                const keyElement = document.querySelector(`[data-key="${keyToHighlight}"]`);
                if (keyElement) {
                    keyElement.classList.add('next');
                }
                
                // Highlight the corresponding finger(s)
                const fingerToUse = fingerMapping[keyToHighlight];
                if (fingerToUse) {
                    const fingerElement = document.querySelector(`[data-finger="${fingerToUse}"]`);
                    if (fingerElement) {
                        fingerElement.classList.add('active');
                    }
                }
                
                // If Shift is needed, also highlight the opposite pinky for Shift
                if (needsShift) {
                    // Determine which Shift key to use based on the main key's finger
                    const mainFinger = fingerMapping[keyToHighlight];
                    let shiftFinger = '';
                    
                    if (mainFinger && mainFinger.startsWith('left')) {
                        shiftFinger = 'right-pinky'; // Use right Shift for left hand keys
                    } else {
                        shiftFinger = 'left-pinky'; // Use left Shift for right hand keys
                    }
                    
                    const shiftFingerElement = document.querySelector(`[data-finger="${shiftFinger}"]`);
                    if (shiftFingerElement) {
                        shiftFingerElement.classList.add('active');
                    }
                }
            }
        }
        
        // Event listeners
        typingInput.addEventListener('click', function(e) {
            // Simple check: if input is disabled and we have a lesson selected
            if (typingInput.disabled && currentLesson !== -1) {
                startLesson();
            }
        });
        
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' && typingInput.disabled && currentLesson !== -1) {
                e.preventDefault();
                startLesson();
                return;
            }
            highlightKey(e.key);
        });
        
        typingInput.addEventListener('input', function(e) {
            const typed = e.target.value;
            
            if (!checkInputMethod(typed)) {
                e.target.value = e.target.value.replace(/[^\x00-\x7F]/g, '');
                return;
            }
            
            if (!isTestActive && currentText) {
                isTestActive = true;
                startTime = Date.now();
                startTimer();
            }
            
            if (!currentText) return;
            
            currentIndex = typed.length;
            
            correctChars = 0;
            for (let i = 0; i < typed.length && i < currentText.length; i++) {
                if (typed[i] === currentText[i]) {
                    correctChars++;
                }
            }
            
            totalChars = typed.length;
            
            displayText();
            highlightNextKey();
            checkUppercaseNeeded(); // Check if uppercase hint is needed
            updateStats();
            
            if (typed === currentText) {
                endTest();
            }
        });
        
        // Handle Enter key press for line breaks
        typingInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                // Don't prevent default for textarea - let it handle line breaks naturally
                
                if (!isTestActive && currentText) {
                    isTestActive = true;
                    startTime = Date.now();
                    startTimer();
                }
            }
        });
        

        
        document.querySelectorAll('.key').forEach(key => {
            key.addEventListener('click', function() {
                const keyValue = this.dataset.key;
                
                if (typingInput.disabled) return;
                
                let currentValue = typingInput.value;
                
                if (keyValue === 'Backspace') {
                    typingInput.value = currentValue.slice(0, -1);
                } else if (keyValue === ' ') {
                    typingInput.value = currentValue + ' ';
                } else if (keyValue === 'Enter') {
                    typingInput.value = currentValue + '\n';
                } else if (keyValue.length === 1) {
                    typingInput.value = currentValue + keyValue;
                }
                
                typingInput.dispatchEvent(new Event('input'));
                typingInput.focus();
            });
        });
        
        // Close modal when clicking outside
        document.getElementById('completionModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Initialize
        initHomepage();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9938507965d0f234',t:'MTc2MTI5Njc0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
